# 로그인 기능 기획서

## 📋 목차
1. [개요](#개요)
2. [기능 요구사항](#기능-요구사항)
3. [UI/UX 디자인 요구사항](#uiux-디자인-요구사항)
4. [기술 요구사항](#기술-요구사항)
5. [API 스펙](#api-스펙)
6. [상태 관리](#상태-관리)
7. [구현 단계](#구현-단계)
8. [테스트 시나리오](#테스트-시나리오)

---

## 개요

### 목적
단풍바람 메생결산 서비스에 사용자 인증 기능을 추가하여, 회원만 접근 가능하도록 보안을 강화하고 개인화된 서비스를 제공합니다.

### 범위
- 로그인 페이지 구현
- 로그인 API 연동
- 로그아웃 기능
- 인증 상태 관리
- 사이드바 사용자 정보 표시

### 대상 사용자
- 단풍바람 동아리 회원 (이름 + 학번으로 인증)

---

## 기능 요구사항

### 1. 로그인 페이지

#### 1.1 입력 필드
- **이름 입력 필드**
  - Placeholder: "이름"
  - 최대 입력 글자수: 3자 (한글 기준)
  - 입력 제한: 초과 입력 시 자동 차단 (경고 메시지 없음)
  
- **학번 입력 필드**
  - Placeholder: "학번"
  - 최대 입력 글자수: 9자
  - 입력 제한: 초과 입력 시 자동 차단 (경고 메시지 없음)
  - 키보드 타입: 숫자 키패드 (기본값)
  - X 버튼: 입력 내용 전체 삭제 기능

#### 1.2 이름 저장 기능
- 체크박스/토글: "이름 저장"
- 기능: 백엔드에서 학번(ID) 저장 처리
- 저장된 이름은 다음 로그인 시 자동 입력

#### 1.3 로그인 버튼
- 텍스트: "메생결산 입장"
- 클릭 시: 로그인 API 호출
- 상태별 스타일:
  - Default: 기본 상태
  - Focused: #000000 불투명도 8% 오버레이

#### 1.4 푸터
- 텍스트: "단풍바람 회원이 이용 가능한 서비스입니다."
- 위치: 화면 하단에서 80px 고정 (Bottom: 80px)

### 2. 로그인 에러 처리

#### 2.1 토스트 메시지
- **트리거**: 로그인 정보가 일치하지 않을 때
- **메시지**: "이름 또는 학번을 확인해 주세요."
- **위치**: 
  - Y 좌표: 상단에서 54px
  - X 좌표: 화면 중앙 정렬
- **애니메이션**:
  - 등장: opacity 0% → 100% (0.5초 이하)
  - 표시 시간: 약 3초
  - 사라짐: opacity 100% → 0% (0.5초 이하)
- **스타일**: 회색 배경, 둥근 모서리

#### 2.2 로그인 실패 시 입력 정보 처리
- **이름 필드**: 입력 정보 유지
- **학번 필드**: 
  - 입력 정보 전체 삭제
  - 커서를 학번 필드에 포커스 (Focused 상태)
  - 키보드 자동 표시

### 3. 로그아웃 기능

#### 3.1 사이드바 로그아웃 버튼
- **위치**: 사이드바 상단, 사용자 이름 옆
- **동작**: 
  - 클릭 시 즉시 로그아웃 (팝업 없음)
  - 로그인 페이지로 이동
  - 세션/토큰 삭제

#### 3.2 사이드바 사용자 정보
- **표시 정보**: 로그인한 사용자 이름
- **위치**: 사이드바 상단
- **표시 조건**: 사이드바가 열렸을 때만 표시

### 4. 인증 상태 관리

#### 4.1 인증 필요 페이지
- 모든 메인 페이지는 로그인 필수
- 미인증 사용자는 자동으로 로그인 페이지로 리다이렉트

#### 4.2 세션 관리
- 로그인 성공 시 세션/토큰 저장
- 페이지 새로고침 시에도 인증 상태 유지
- 로그아웃 시 세션/토큰 삭제

---

## UI/UX 디자인 요구사항

### 1. 로그인 페이지 레이아웃

#### 1.1 배경
- 색상: `#FFF3E0` (bg-app)
- 전체 화면 배경

#### 1.2 앱 타이틀
- 텍스트: "단풍바람"
- 스타일: 큰 볼드체, 흰색
- 위치: 화면 중앙 상단

#### 1.3 입력 필드 디자인
- **InputBox Component 사용**
- **상태별 디자인**:
  - **Default**: 기본 상태
    - 배경색: 약간 어두운 오렌지 (`#fac486` 또는 유사)
    - 테두리: 둥근 모서리
    - 플레이스홀더: 흰색 텍스트
  - **Focused**: InputBox 클릭 시
    - 포커스 스타일 적용
    - 다른 화면 클릭 시 Default로 전환
  - **X 버튼**: 
    - 학번 필드에만 표시 (입력 내용이 있을 때)
    - 회색 원형 배경
    - 클릭 시 입력 내용 전체 삭제

#### 1.4 버튼 디자인
- **Button Component 사용**
- **상태별 디자인**:
  - **Default**: 흰색 배경, 검은색 텍스트
  - **Focused**: #000000 불투명도 8% 오버레이

#### 1.5 이름 저장 체크박스
- 스타일: 원형 체크박스
- 체크 상태: 오렌지 체크마크
- 미체크 상태: 얇은 오렌지 테두리

### 2. 반응형 디자인
- 모바일 우선 설계
- 최소 너비: 320px
- 키보드 표시 시 레이아웃 조정

### 3. 접근성
- ARIA 레이블 추가
- 키보드 네비게이션 지원
- 포커스 관리

---

## 기술 요구사항

### 1. 컴포넌트 구조

```
src/lib/components/
├── InputBox.svelte          # 입력 필드 컴포넌트 (신규)
├── Button.svelte            # 버튼 컴포넌트 (신규)
├── Toast.svelte             # 토스트 메시지 컴포넌트 (신규)
└── Sidebar.svelte           # 사이드바 (수정)

src/routes/
├── login/
│   └── +page.svelte         # 로그인 페이지 (신규)
└── +layout.svelte           # 레이아웃 (수정 - 인증 체크)

src/lib/
├── stores/
│   └── auth.ts              # 인증 상태 스토어 (신규)
├── utils/
│   └── api.ts               # API 유틸리티 (수정)
└── types.ts                 # 타입 정의 (수정)
```

### 2. InputBox Component 스펙

```typescript
interface InputBoxProps {
  type?: 'text' | 'number' | 'tel';
  placeholder: string;
  value: string;
  maxLength?: number;
  state?: 'default' | 'focused';
  showClearButton?: boolean;
  onInput: (value: string) => void;
  onFocus: () => void;
  onBlur: () => void;
  onClear?: () => void;
}
```

**상태 관리**:
- `default`: 기본 상태
- `focused`: 포커스 상태 (클릭 시)

**기능**:
- 최대 글자수 제한
- X 버튼 표시/숨김 (입력 내용 있을 때만)
- 키보드 타입 지정 (학번 필드는 숫자 키패드)

### 3. Button Component 스펙

```typescript
interface ButtonProps {
  label: string;
  variant?: 'primary' | 'secondary';
  state?: 'default' | 'focused' | 'disabled';
  onClick: () => void;
  type?: 'button' | 'submit';
}
```

**상태 관리**:
- `default`: 기본 상태
- `focused`: 포커스 상태 (#000000 opacity 8%)
- `disabled`: 비활성화 상태

### 4. Toast Component 스펙

```typescript
interface ToastProps {
  message: string;
  duration?: number; // 기본값: 3000ms
  show: boolean;
  onClose: () => void;
}
```

**애니메이션**:
- 등장: opacity 0 → 100 (0.5초)
- 사라짐: opacity 100 → 0 (0.5초)
- 위치: 상단 54px, 중앙 정렬

### 5. 인증 스토어 (auth.ts)

```typescript
interface AuthState {
  isAuthenticated: boolean;
  user: {
    name: string;
    studentId: string;
  } | null;
  isLoading: boolean;
}

// Actions
- login(name: string, studentId: string): Promise<void>
- logout(): void
- checkAuth(): Promise<void>
```

**저장소**:
- 로컬 스토리지 또는 쿠키 사용
- 세션/토큰 저장

### 6. API 엔드포인트

#### 6.1 로그인
```
POST /api/auth/login
Request Body:
{
  name: string;
  studentId: string;
  saveName?: boolean;
}

Response (Success):
{
  success: true;
  token: string;
  user: {
    name: string;
    studentId: string;
  }
}

Response (Error):
{
  success: false;
  message: string;
}
```

#### 6.2 로그아웃
```
POST /api/auth/logout
Headers:
  Authorization: Bearer {token}

Response:
{
  success: true;
}
```

#### 6.3 인증 확인
```
GET /api/auth/verify
Headers:
  Authorization: Bearer {token}

Response:
{
  success: true;
  user: {
    name: string;
    studentId: string;
  }
}
```

---

## 상태 관리

### 1. 인증 상태 플로우

```
[로그인 페이지]
    ↓ (입력)
[이름 + 학번 입력]
    ↓ (제출)
[API 호출]
    ↓
[성공] → [메인 페이지로 이동] → [인증 상태 저장]
    ↓
[실패] → [토스트 메시지 표시] → [학번 필드 초기화]
```

### 2. 페이지 접근 제어

```
[페이지 접근 시도]
    ↓
[인증 상태 확인]
    ↓
[인증됨] → [페이지 표시]
    ↓
[미인증] → [로그인 페이지로 리다이렉트]
```

### 3. 사이드바 상태

```
[사이드바 열기]
    ↓
[인증 상태 확인]
    ↓
[인증됨] → [사용자 이름 표시 + 로그아웃 버튼]
    ↓
[미인증] → [로그인 페이지로 리다이렉트]
```

---

## 구현 단계

### Phase 1: 기본 컴포넌트 개발
1. ✅ InputBox 컴포넌트 구현
   - 상태 관리 (default/focused)
   - 최대 글자수 제한
   - X 버튼 기능
   - 키보드 타입 지정

2. ✅ Button 컴포넌트 구현
   - 상태 관리 (default/focused)
   - 포커스 스타일

3. ✅ Toast 컴포넌트 구현
   - 애니메이션 (fade in/out)
   - 자동 사라짐

### Phase 2: 로그인 페이지 구현
4. ✅ 로그인 페이지 레이아웃
   - 배경, 타이틀
   - 입력 필드 배치
   - 버튼 배치
   - 체크박스 배치
   - 푸터 배치

5. ✅ 로그인 로직 구현
   - 폼 검증
   - API 호출
   - 에러 처리
   - 성공 시 리다이렉트

### Phase 3: 인증 상태 관리
6. ✅ 인증 스토어 구현
   - 상태 관리
   - 로컬 스토리지 연동
   - API 연동

7. ✅ 레이아웃 수정
   - 인증 체크 미들웨어
   - 리다이렉트 로직

### Phase 4: 사이드바 수정
8. ✅ 사이드바 사용자 정보 표시
   - 사용자 이름 표시
   - 로그아웃 버튼 추가

9. ✅ 로그아웃 기능 구현
   - 로그아웃 API 호출
   - 상태 초기화
   - 리다이렉트

### Phase 5: 테스트 및 최적화
10. ✅ 브라우저 테스트
    - 데스크톱 테스트
    - 모바일 테스트 (375px)
    - 키보드 동작 테스트

11. ✅ 에러 케이스 테스트
    - 잘못된 입력
    - 네트워크 에러
    - 세션 만료

12. ✅ 성능 최적화
    - 불필요한 리렌더링 방지
    - 애니메이션 최적화

---

## 테스트 시나리오

### 1. 로그인 성공 시나리오
1. 로그인 페이지 접속
2. 이름 입력 (예: "강민아")
3. 학번 입력 (예: "123456789")
4. "이름 저장" 체크박스 선택 (선택사항)
5. "메생결산 입장" 버튼 클릭
6. ✅ 메인 페이지로 이동 확인
7. ✅ 사이드바에 사용자 이름 표시 확인

### 2. 로그인 실패 시나리오
1. 로그인 페이지 접속
2. 잘못된 이름 또는 학번 입력
3. "메생결산 입장" 버튼 클릭
4. ✅ 토스트 메시지 표시 확인 ("이름 또는 학번을 확인해 주세요.")
5. ✅ 이름 필드는 유지 확인
6. ✅ 학번 필드 초기화 확인
7. ✅ 학번 필드에 포커스 확인
8. ✅ 키보드 자동 표시 확인

### 3. 입력 제한 테스트
1. 이름 필드에 4자 이상 입력 시도
2. ✅ 3자까지만 입력되는지 확인
3. 학번 필드에 10자 이상 입력 시도
4. ✅ 9자까지만 입력되는지 확인

### 4. 키보드 타입 테스트
1. 학번 필드 클릭
2. ✅ 숫자 키패드가 표시되는지 확인

### 5. X 버튼 테스트
1. 학번 필드에 입력
2. ✅ X 버튼 표시 확인
3. X 버튼 클릭
4. ✅ 입력 내용 삭제 확인

### 6. 이름 저장 기능 테스트
1. 로그인 시 "이름 저장" 체크
2. 로그인 성공
3. 로그아웃
4. 다시 로그인 페이지 접속
5. ✅ 이름 필드에 저장된 이름 자동 입력 확인

### 7. 로그아웃 테스트
1. 로그인 상태에서 사이드바 열기
2. 로그아웃 버튼 클릭
3. ✅ 팝업 없이 즉시 로그아웃 확인
4. ✅ 로그인 페이지로 이동 확인
5. ✅ 인증 상태 초기화 확인

### 8. 인증 상태 유지 테스트
1. 로그인 성공
2. 페이지 새로고침
3. ✅ 로그인 상태 유지 확인
4. ✅ 메인 페이지 접근 가능 확인

### 9. 미인증 접근 테스트
1. 로그아웃 상태
2. 메인 페이지 URL 직접 접근
3. ✅ 로그인 페이지로 리다이렉트 확인

### 10. 반응형 테스트
1. 모바일 크기 (375px)에서 테스트
2. ✅ 레이아웃 정상 표시 확인
3. ✅ 키보드 표시 시 레이아웃 조정 확인
4. ✅ 푸터 위치 확인 (하단 80px)

---

## 추가 고려사항

### 1. 보안
- 입력값 검증 (XSS 방지)
- HTTPS 사용
- 토큰 만료 시간 설정
- CSRF 방지

### 2. 사용자 경험
- 로딩 상태 표시
- 네트워크 에러 처리
- 오프라인 상태 처리

### 3. 성능
- API 호출 최적화
- 불필요한 리렌더링 방지
- 애니메이션 성능 최적화

### 4. 접근성
- 스크린 리더 지원
- 키보드 네비게이션
- 포커스 관리

---

## 참고 자료

### 디자인 참고
- 로그인 페이지 디자인 이미지
- 에러 처리 디자인 이미지
- 사이드바 디자인 이미지

### 기술 스택
- SvelteKit
- TypeScript
- Tailwind CSS
- Svelte 5 ($state, $derived)

---

## 체크리스트

### 개발 전
- [ ] 기획서 검토
- [ ] API 스펙 확인
- [ ] 디자인 확인

### 개발 중
- [ ] 컴포넌트 구현
- [ ] API 연동
- [ ] 상태 관리 구현
- [ ] 에러 처리 구현

### 개발 후
- [ ] 브라우저 테스트
- [ ] 모바일 테스트
- [ ] 접근성 테스트
- [ ] 성능 테스트
- [ ] 코드 리뷰
- [ ] 문서화

---

**작성일**: 2025-01-XX  
**작성자**: 단풍바람 개발팀  
**버전**: 1.0
